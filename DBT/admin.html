<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DBT Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/style.css" />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: {
                50: "#eef2ff",
                100: "#e0e7ff",
                200: "#c7d2fe",
                300: "#a5b4fc",
                400: "#818cf8",
                500: "#6366f1",
                600: "#4f46e5",
                700: "#4338ca",
                800: "#3730a3",
                900: "#312e81",
              },
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-slate-50 font-inter">
    <!-- Header -->
    <header class="bg-white shadow sticky top-0 z-50">
      <div
        class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center"
      >
        <div class="text-xl font-semibold text-primary-700">
          DBT Admin Dashboard
        </div>
        <nav class="flex items-center gap-6">
          <a href="./index.html" class="text-slate-700 hover:text-primary-600"
            >Home</a
          >
          <a href="#" class="text-slate-700 hover:text-primary-600">Settings</a>
          <a href="#" class="text-slate-700 hover:text-primary-600">Logout</a>
        </nav>
      </div>
    </header>

    <main class="max-w-7xl mx-auto p-6">
      <!-- Quick Stats -->
      <section
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"
      >
        <div class="bg-white p-5 rounded-2xl shadow hover:shadow-md transition">
          <div class="text-slate-500 text-sm">üë• Students Reached</div>
          <div id="students-reached" class="mt-2 text-3xl font-semibold">0</div>
        </div>
        <div class="bg-white p-5 rounded-2xl shadow hover:shadow-md transition">
          <div class="text-slate-500 text-sm">‚úÖ DBT Accounts Verified</div>
          <div id="dbt-verified" class="mt-2 text-3xl font-semibold">0</div>
        </div>
        <div class="bg-white p-5 rounded-2xl shadow hover:shadow-md transition">
          <div class="text-slate-500 text-sm">üì£ Campaigns</div>
          <div id="campaign-count" class="mt-2 text-3xl font-semibold">0</div>
        </div>
        <div class="bg-white p-5 rounded-2xl shadow hover:shadow-md transition">
          <div class="text-slate-500 text-sm">üéì Quizzes Active</div>
          <div id="quiz-count" class="mt-2 text-3xl font-semibold">0</div>
        </div>
      </section>

      <!-- Students Table -->
      <section class="bg-white p-6 rounded-2xl shadow mb-8">
        <h2 class="text-lg font-semibold mb-4">Student Management</h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-slate-200">
            <thead class="bg-slate-100">
              <tr>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  Name
                </th>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  Aadhaar Number
                </th>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  DBT Status
                </th>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  Actions
                </th>
              </tr>
            </thead>
            <tbody id="students-table" class="divide-y divide-slate-200">
              <!-- Students will be dynamically inserted here -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- Campaigns Section -->
      <section class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8">
        <div class="bg-white p-6 rounded-2xl shadow hover:shadow-md transition">
          <h3 class="font-semibold mb-2">Add Campaign</h3>
          <button
            class="bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700"
          >
            + New Campaign
          </button>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow hover:shadow-md transition">
          <h3 class="font-semibold mb-2">Campaign Analytics</h3>
          <canvas id="campaignChart" class="w-full h-40"></canvas>
        </div>
      </section>

      <!-- Scholarships Section -->
      <section class="bg-white p-6 rounded-2xl shadow mb-8">
        <h2 class="text-lg font-semibold mb-4">Scholarships</h2>
        <div
          id="scholarship-container"
          class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3"
        >
          <!-- Scholarships dynamically loaded -->
        </div>
      </section>

      <!-- Quizzes Section -->
      <section class="bg-white p-6 rounded-2xl shadow mb-8">
        <h2 class="text-lg font-semibold mb-4">Quiz Management</h2>
        <button
          class="bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700 mb-4"
        >
          + Add Quiz
        </button>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-slate-200">
            <thead class="bg-slate-100">
              <tr>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  Quiz Title
                </th>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  Questions
                </th>
                <th
                  class="px-4 py-2 text-left text-sm font-medium text-slate-700"
                >
                  Actions
                </th>
              </tr>
            </thead>
            <tbody id="quiz-table" class="divide-y divide-slate-200">
              <!-- Quizzes dynamically loaded -->
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Placeholder data (replace with backend fetch)
      const students = [
        {
          name: "Aditi Basavaraj",
          aadhaar: "123412341234",
          account: "111122223333",
        },
        {
          name: "Rohan Kumar",
          aadhaar: "987698769876",
          account: "444455556666",
        },
        {
          name: "Ananya Sharma",
          aadhaar: "123443211234",
          account: "999988887777",
        },
      ];

      const dbtAccounts = {
        123412341234: { account: "111122223333", bank: "SBI" },
        987698769876: { account: "444455556666", bank: "HDFC" },
      };

      function loadStudents() {
        const tbody = document.getElementById("students-table");
        tbody.innerHTML = "";
        let verifiedCount = 0;

        students.forEach((s) => {
          const dbt = dbtAccounts[s.aadhaar]
            ? dbtAccounts[s.aadhaar].account === s.account
              ? "‚úÖ DBT-enabled"
              : "‚ùå Wrong account"
            : "‚ùå Not linked";
          if (dbt === "‚úÖ DBT-enabled") verifiedCount++;

          const row = document.createElement("tr");
          row.innerHTML = `
            <td class="px-4 py-2">${s.name}</td>
            <td class="px-4 py-2">${s.aadhaar}</td>
            <td class="px-4 py-2">${dbt}</td>
            <td class="px-4 py-2 flex gap-2">
              <button class="bg-primary-600 text-white px-3 py-1 rounded hover:bg-primary-700">Edit</button>
              <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">Delete</button>
            </td>
          `;
          tbody.appendChild(row);
        });

        document.getElementById("students-reached").textContent =
          students.length;
        document.getElementById("dbt-verified").textContent = verifiedCount;
      }

      function loadScholarships() {
        fetch("http://localhost:5000/scholarships")
          .then((res) => res.json())
          .then((data) => {
            const container = document.getElementById("scholarship-container");
            container.innerHTML = "";
            data.forEach((s) => {
              const card = document.createElement("div");
              card.className =
                "rounded-2xl border border-slate-200 p-6 bg-white shadow-sm hover:shadow-md transition";
              card.innerHTML = `
                <h3 class="text-lg font-semibold text-primary-600">${s.title}</h3>
                <p class="mt-2 text-slate-700 text-sm">${s.description}</p>
                <div class="mt-4 flex gap-2">
                  <a class="px-3 py-1 bg-primary-600 text-white rounded hover:bg-primary-700 text-sm" href="${s.applyLink}" target="_blank">Apply</a>
                  <a class="px-3 py-1 bg-slate-200 text-slate-800 rounded hover:bg-slate-300 text-sm" href="${s.formLink}" download>Download Form</a>
                </div>
              `;
              container.appendChild(card);
            });
          })
          .catch((err) => console.error("Error loading scholarships:", err));
      }

      function loadQuiz() {
        const quizzes = [
          { title: "DBT Basics", questions: 10 },
          { title: "Scholarship Awareness", questions: 8 },
        ];
        const tbody = document.getElementById("quiz-table");
        tbody.innerHTML = "";
        quizzes.forEach((q) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td class="px-4 py-2">${q.title}</td>
            <td class="px-4 py-2">${q.questions}</td>
            <td class="px-4 py-2 flex gap-2">
              <button class="bg-primary-600 text-white px-3 py-1 rounded hover:bg-primary-700">Edit</button>
              <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">Delete</button>
            </td>
          `;
          tbody.appendChild(row);
        });
        document.getElementById("quiz-count").textContent = quizzes.length;
      }

      // Chart
      const ctx = document.getElementById("campaignChart").getContext("2d");
      new Chart(ctx, {
        type: "bar",
        data: {
          labels: ["Campaign 1", "Campaign 2", "Campaign 3"],
          datasets: [
            {
              label: "Students Reached",
              data: [120, 90, 150],
              backgroundColor: "#6366f1",
            },
          ],
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true } },
        },
      });

      // Initialize
      loadStudents();
      loadScholarships();
      loadQuiz();
    </script>
  </body>
</html>
